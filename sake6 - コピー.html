<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お酒診断アプリ</title>
    <!-- Tailwind CSSのCDNを読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Interフォントを適用 */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* テキスト内の改行を保持 */
        .whitespace-pre-line {
            white-space: pre-line;
        }
        /* 質問文のフェードイン/アウトを制御するスタイル */
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.5s ease;
        }
        .fade-enter, .fade-leave-to {
            opacity: 0;
        }
        /* ボタンのクリック時にスケールダウンする効果 */
        .btn-active-scale:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

<div id="app" class="bg-white rounded-xl shadow-lg p-8 w-full max-w-lg text-center flex flex-col items-center">
    <!-- 質問文のコンテナ -->
    <div id="question-container" class="min-h-[120px] mb-8 flex items-center justify-center transition-opacity duration-500">
        <p id="question-text" class="text-xl md:text-2xl font-bold text-gray-800 whitespace-pre-line"></p>
    </div>

    <!-- 選択肢ボタンのコンテナ -->
    <div id="options-container" class="space-y-4 w-full">
        <button id="option1-btn" class="option-btn bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-4 px-6 rounded-full w-full transition duration-300 transform btn-active-scale shadow-md">選択肢 1</button>
        <button id="option2-btn" class="option-btn bg-purple-500 hover:bg-purple-600 text-white font-bold py-4 px-6 rounded-full w-full transition duration-300 transform btn-active-scale shadow-md">選択肢 2</button>
    </div>

    <!-- 結果表示と再診断ボタンのコンテナ -->
    <div id="result-container" class="hidden flex-col items-center mt-8">
        <p id="result-text" class="text-2xl font-bold text-green-700 whitespace-pre-line leading-relaxed"></p>
        <button id="restart-btn" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full mt-6 transition duration-300 transform btn-active-scale shadow-md">もう一度診断する</button>
    </div>
</div>

<script>
    // 診断ツリーのノードを表すクラス
    class Node {
        constructor(text) {
            this.text = text;
            this.option1 = null;
            this.option2 = null;
        }

        isLeaf() {
            return this.option1 === null && this.option2 === null;
        }
    }

    // DOM要素の取得
    const app = document.getElementById('app');
    const questionContainer = document.getElementById('question-container');
    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options-container');
    const option1Btn = document.getElementById('option1-btn');
    const option2Btn = document.getElementById('option2-btn');
    const resultContainer = document.getElementById('result-container');
    const resultText = document.getElementById('result-text');
    const restartBtn = document.getElementById('restart-btn');

    let currentNode;
    let selectedChoices = [];

    // 診断ツリーの構築
    function buildTree() {
        // ルートノードを新しい質問に変更
        const root = new Node("どんな目的で日本酒を選びますか？\n1: お土産用\n2: 自分用");
        
        const souvenirPurpose = new Node("火入れ酒と生酒、どちらが良いですか？\n1: 火入れ酒（常温保存可）\n2: 生酒（要冷蔵）");
        const souvenirPasteurized = new Node("発送かお持ち帰りか、どちらが良いですか？\n1: 発送\n2: お持ち帰り");
        const souvenir1 = new Node("甘口と辛口、どちらがお好みですか？\n1: 甘口\n2: 辛口");
        const result1 = new Node("結果");
        const result2 = new Node("結果");
        const souvenirUnpasteurized = new Node("甘口と辛口、どちらがお好みですか？\n1: 甘口\n2: 辛口");
        const result3 = new Node("結果");
        const result4 = new Node("結果");

        const personalPurpose = new Node("火入れ酒と生酒、どちらが良いですか？\n1: 火入れ酒（常温保存可）\n2: 生酒（要冷蔵）");
        const personalPasteurized = new Node("容量はどちらが良いですか？\n1: 720mL\n2: 1800mL");
        const personal1 = new Node("甘口と辛口、どちらがお好みですか？\n1: 甘口\n2: 辛口");
        const result5 = new Node("結果");
        const result6 = new Node("結果");
        const personalUnpasteurized = new Node("甘口と辛口、どちらがお好みですか？\n1: 甘口\n2: 辛口");
        const result7 = new Node("結果");
        const result8 = new Node("結果");

        // ツリー構造の定義
        root.option1 = souvenirPurpose;
        root.option2 = personalPurpose;

        souvenirPurpose.option1 = souvenirPasteurized;
        souvenirPurpose.option2 = souvenirUnpasteurized;
        souvenirPasteurized.option1 = souvenir1;
        souvenirPasteurized.option2 = souvenir1;
        souvenir1.option1 = result1;
        souvenir1.option2 = result2;

        souvenirUnpasteurized.option1 = result3;
        souvenirUnpasteurized.option2 = result4;
        
        personalPurpose.option1 = personalPasteurized;
        personalPurpose.option2 = personalUnpasteurized;
        personalPasteurized.option1 = personal1;
        personalPasteurized.option2 = personal1;
        personal1.option1 = result5;
        personal1.option2 = result6;

        personalUnpasteurized.option1 = result7;
        personalUnpasteurized.option2 = result8;

        return root;
    }

    function getButtonText(nodeText) {
        // 質問文からボタンに表示するテキストを抽出
        if (nodeText.includes('\n')) {
            const parts = nodeText.split('\n');
            const buttonText = parts[1] || parts[0];
            return buttonText.trim().substring(3); // "1: " or "2: " を取り除く
        }
        return nodeText;
    }

    function processChoice(choice) {
        // 質問を非表示にしてフェードアウト
        questionContainer.classList.remove('fade-enter-active');
        questionContainer.classList.add('fade-leave-active');
        questionText.classList.add('fade-leave-to');

        // 選択された内容を記録
        const selectedText = choice === 1 ? option1Btn.textContent : option2Btn.textContent;
        selectedChoices.push(selectedText);

        // ボタンを非表示
        optionsContainer.style.opacity = '0';
        optionsContainer.style.pointerEvents = 'none';

        setTimeout(() => {
            // フェードアウト完了後に次のノードへ移動
            if (choice === 1 && currentNode.option1) {
                currentNode = currentNode.option1;
            } else if (choice === 2 && currentNode.option2) {
                currentNode = currentNode.option2;
            } else {
                // エラー処理
                console.error("Invalid choice.");
                return;
            }
            displayCurrentNode();
        }, 500); // CSSアニメーションの時間と合わせる
    }

    function displayCurrentNode() {
        if (currentNode.isLeaf()) {
            // 最終結果の表示
            questionContainer.style.display = 'none';
            optionsContainer.style.display = 'none';
            resultContainer.style.display = 'flex';
            
            // 選択された内容を組み合わせて要約を作成
            let summaryText = "あなたが選んだ日本酒は...";
            if(selectedChoices.length > 0) {
                summaryText += "\n\n";
                summaryText += selectedChoices.join("・") + "の組み合わせです。";
            }
            summaryText += "\n\n他に気になることがありましたら、店員にご相談ください。";

            resultText.textContent = summaryText;
        } else {
            // 質問の表示
            questionContainer.classList.remove('fade-leave-active');
            questionContainer.classList.add('fade-enter-active');
            questionText.classList.remove('fade-leave-to');
            questionText.textContent = currentNode.text;

            optionsContainer.style.opacity = '1';
            optionsContainer.style.pointerEvents = 'auto';

            // ボタンのテキストを設定
            option1Btn.textContent = getButtonText(currentNode.text.split('\n')[1]);
            option2Btn.textContent = getButtonText(currentNode.text.split('\n')[2]);
        }
    }

    function restartDiagnosis() {
        // 画面をリセット
        questionContainer.style.display = 'flex';
        optionsContainer.style.display = 'flex';
        resultContainer.style.display = 'none';
        
        // 選択履歴をリセット
        selectedChoices = [];

        // ツリーを最初から構築
        currentNode = buildTree();
        displayCurrentNode();
    }

    // イベントリスナーの設定
    option1Btn.addEventListener('click', () => processChoice(1));
    option2Btn.addEventListener('click', () => processChoice(2));
    restartBtn.addEventListener('click', restartDiagnosis);

    // アプリケーションの開始
    currentNode = buildTree();
    displayCurrentNode();
</script>

</body>
</html>
```